<!--https://github.com/ajaxorg/ace/blob/master/lib/ace/ext/options.js-->
<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <title>Preferences</title>
    <link rel="shortcut icon" href="../assets/icons/png/preferences.png" />
    <link href="../lib/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="../lib/bootstrap-theme.min.css" rel="stylesheet" type="text/css" />
    <link href="../lib/bootstrap-select.min.css" rel="stylesheet" type="text/css" />
    <link href="../lib/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="css/form.css" rel="stylesheet" type="text/css" />
    <style>
        body {
            -webkit-user-select: none;
            user-select: none;
        }

        .col-lg-1,
        .col-lg-10,
        .col-lg-11,
        .col-lg-12,
        .col-lg-2,
        .col-lg-3,
        .col-lg-4,
        .col-lg-5,
        .col-lg-6,
        .col-lg-7,
        .col-lg-8,
        .col-lg-9,
        .col-md-1,
        .col-md-10,
        .col-md-11,
        .col-md-12,
        .col-md-2,
        .col-md-3,
        .col-md-4,
        .col-md-5,
        .col-md-6,
        .col-md-7,
        .col-md-8,
        .col-md-9,
        .col-sm-1,
        .col-sm-10,
        .col-sm-11,
        .col-sm-12,
        .col-sm-2,
        .col-sm-3,
        .col-sm-4,
        .col-sm-5,
        .col-sm-6,
        .col-sm-7,
        .col-sm-8,
        .col-sm-9,
        .col-xs-1,
        .col-xs-10,
        .col-xs-11,
        .col-xs-12,
        .col-xs-2,
        .col-xs-3,
        .col-xs-4,
        .col-xs-5,
        .col-xs-6,
        .col-xs-7,
        .col-xs-8,
        .col-xs-9 {
            padding-right: 0px;
            padding-left: 0px;
        }
    </style>
    <script>
        if (typeof module === 'object') { window.module = module; module = undefined; }
    </script>
    <script src="../lib/jquery.min.js"></script>
    <script src="../lib/bootstrap.min.js"></script>
    <script src="../lib/bootstrap-select.min.js"></script>
    <script src="../lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="../lib/ace/ext-themelist.js" type="text/javascript"></script>
    <script>
        /* global ace */
        //cSpell:ignore rgbcolor cmdfont selectpicker commandon prepend tablist tabpanel lagmeter hellip emoteto  ABCDEFGHIJKLMNOPQRSTUVWXYZ
        const { TempType } = require('./js/types');
        const { parseTemplate } = require("./js/library.js");
        const { remote, ipcRenderer } = require('electron');
        const { dialog } = remote;
        const path = require('path');
        const EditorSettings = require('./js/editor/code.editor.settings').EditorSettings;

        var _settings;
        if (window.module) module.module;
        $(window).keydown((event) => {
            if (event.which === 27)
                window.close();
        });

        $(document).ready(() => {
            if (process.platform === 'win32')
                $('.win32').css('display', 'block');
            else
                $('.win32').css('display', 'none');
            _settings = EditorSettings.load(parseTemplate(path.join('{data}', 'editor.json')));
           
            loadSettings();
            $('input[type="checkbox"]').change(function () {
                switch ($(this).attr('id')) {
                    case 'alwaysOnTopClient':
                    case 'persistent':
                    case 'alwaysOnTop':
                        _settings.window[$(this).attr('id')] = this.checked;
                        break;
                    default:
                        setValue($(this).attr('id'), this.checked);
                        break;
                }
            });

            $('input[type="radio"]').change(function () {

            });

            $('input[type="text"]').change(function () {
                setValue($(this).attr('id'), $(this).val());
            });
            $('input[type="number"]').change(function () {
                setValue($(this).attr('id'), $(this).val());
            });
            $('.selectpicker').change(function () {
                setValue($(this).attr('id'), $(this).val());
            });
        });

        function setValue(option, value) {
            if (value == "false") value = false;
            if (value == "true") value = true;
            if (value == "null") value = null;
            if (value == "undefined") value = undefined;
            if (typeof value == "string" && parseFloat(value).toString() == value)
                value = parseFloat(value);
            option = option.split('-');
            if (option.length === 2)
                _settings[option[0]][option[1]] = value;
            else
                _settings[option[0]] = value;
        }

        function loadSettings() {
            $("#reopen").prop('checked', _settings.reopen);
            $("#maxRecent").val(_settings.maxRecent);
            let option;
            for (option in _settings.editorOptions) {
                if (!_settings.editorOptions.hasOwnProperty(option))
                    continue;
                if (typeof (_settings.editorOptions[option]) !== "boolean")
                    continue;
                $('#editorOptions-' + option).prop('checked', _settings.editorOptions[option]);
            }

            $("#persistent").prop('checked', _settings.window.persistent);
            $("#alwaysOnTopClient").prop('checked', _settings.window.alwaysOnTopClient);
            $("#alwaysOnTop").prop('checked', _settings.window.alwaysOnTop);

            $('.btn-group input').parent().removeClass('active');
            $('.btn-group input:checked').parent().addClass('active');
        }

        function resetSettings() {
            _settings = new EditorSettings();
            loadSettings();
        }

        function saveSettings() {
            _settings.save(parseTemplate(path.join('{data}', 'editor.json')));
            ipcRenderer.send('editor-setting-changed', _settings.window);
            window.close();
        }
    </script>
</head>

<body>
    <div class="dialog-body">
        <ul class="nav nav-tabs" role="tablist" style="background-color: #F5F5F5;box-shadow: inset 0 -1px 0 #fff;">
            <li role="presentation" class="active">
                <a href="#general" aria-controls="general" role="tab" data-toggle="tab">General</a>
            </li>
            <li role="presentation">
                <a href="#editor" aria-controls="editor" role="tab" data-toggle="tab">Editor</a>
            </li>
            <li role="presentation">
                <a href="#window" aria-controls="window" role="tab" data-toggle="tab">Window</a>
            </li>
            <li role="presentation">
                <a href="#advanced" aria-controls="advanced" role="tab" data-toggle="tab">Advanced Editor</a>
            </li>
        </ul>
        <div class="tab-content" style="overflow: auto;height: 324px;">
            <div role="tabpanel" class="container tab-pane fade in active" id="general">
                <div class="col-sm-6 form-group">
                    <label class="control-label">
                        Max recent items
                        <input type="number" id="maxRecent" class="input-sm form-control" min="1" max="2000" style="width: 100px" />
                    </label>
                </div>
                <div class="col-sm-6 form-group">
                    <label class="control-label">
                        <input type="checkbox" id="nativeIcons" /> Use native icons in tabs
                    </label>
                </div>                
                <div class="col-sm-6 form-group">
                    <label class="control-label">
                        <input type="checkbox" id="reopen" /> Remember open files on reload
                    </label>
                </div>
            </div>
            <div role="tabpanel" class="container tab-pane fade" id="editor">
                <!--
                <div class="col-xs-6 form-group">
                    <label class="control-label">
                        <input type="checkbox" id="spellchecking" /> Spellchecking
                    </label>
                </div>
                -->
            </div>
            <div role="tabpanel" class="container tab-pane fade" id="window">
                <div class="col-xs-12">
                    <div class="col-xs-6 form-group">
                        <label class="control-label">
                            <input type="checkbox" id="alwaysOnTopClient" /> Always on top of client
                            <span class="win32 help-block" style="display:none;font-size: 0.8em;margin:0;padding:0">Requires restart</span>
                            <span class="help-block" style="font-size: 0.8em;margin:0;padding:0">When disabled editor will remain open even if client closed</span>
                        </label>
                    </div>
                    <div class="col-xs-6 form-group">
                        <label class="control-label">
                            <input type="checkbox" id="alwaysOnTop" /> Always on top of all
                        </label>
                    </div>
                </div>
                <div class="col-xs-6 form-group">
                    <label class="control-label">
                        <input type="checkbox" id="persistent" /> Persistent
                        <span class="help-block" style="font-size: 0.8em;margin:0;padding:0">Not applied when in editor only mode</span>
                    </label>
                </div>
            </div>
            <div role="tabpanel" class="container tab-pane fade" id="advanced">
                
            </div>
        </div>
        <div class="dialog-footer">
            <button style="float: left" type="button" class="btn btn-default" onclick="resetSettings()">Reset</button>
            <button style="float: right" type="button" class="btn btn-default" onclick="window.close()">Cancel</button>
            <button style="float: right" type="button" class="btn btn-primary" onclick="saveSettings()">Ok</button>
        </div>
</body>

</html>