<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <title>Immortal Tools</title>
    <link rel="shortcut icon" href="../assets/icons/png/ied.png" />
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap-theme.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap-select.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap-treeview.min.css" rel="stylesheet" type="text/css" />
    <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="css/ied.css" rel="stylesheet" type="text/css" />
    <link href="css/form.css" rel="stylesheet" type="text/css" />
    <link href="css/datatables.min.css" rel="stylesheet" type="text/css" />
    <script>
        if (typeof module === 'object') { window.module = module; module = undefined; }
    </script>
    <script src="../lib/jquery.min.js" type="text/javascript"></script>
    <script src="../lib/bootstrap.min.js" type="text/javascript"></script>
    <script src="../lib/bootstrap-select.min.js" type="text/javascript"></script>
    <script src="../lib/datatables.min.js" type="text/javascript"></script>
    <script src="../lib/datatables.scrollResize.js" type="text/javascript"></script>
    <script>
        //cSpell:ignore hellip vscroll hscroll ungroup crosshairs haspopup tablist tabpanel labelledby
        const { IED, CacheType, Echo, fileInfo } = require('./js/ied');
        const { remote, ipcRenderer } = require('electron');
        const { app, nativeImage, dialog, Menu, MenuItem } = remote;
        const { parseTemplate } = require('./js/library');
        const { Settings } = require('./js/settings');
        const fs = require('fs');
        const path = require('path');
        const drivelist = require('drivelist');
        const moment = require('moment');

        var _ied, options, dropdownMenu;
        var _local = {}, _remote = {};

        var menu = [
            {
                label: '&File',
                id: 'file',
                submenu: [
                    {
                        label: '&Upload',
                        accelerator: "CmdOrCtrl+U",
                        enabled: false,
                        click: () => {

                        }
                    },
                    {
                        label: '&Download',
                        accelerator: "CmdOrCtrl+D",
                        enabled: false,
                        click: () => {

                        }
                    },
                    { type: 'separator' },
                    /*
                    {
                        label: 'R&estart',
                        enabled: false,
                        click: () => {

                        }
                    },
                    {
                        label: '&Pause',
                        enabled: false,
                        click: () => {

                        }
                    },
                    {
                        label: '&Stop',
                        enabled: false,
                        click: () => {

                        }
                    },
                    { type: 'separator' },
                    */
                    {
                        label: '&Reset all',
                        accelerator: "CmdOrCtrl+R",
                        click: () => {

                        }
                    },
                    { type: 'separator' },
                    {
                        label: '&Close',
                        click: () => { window.close(); }
                    }
                ]
            },
            {
                label: '&Edit',
                submenu: [
                    {
                        label: '&Refresh',
                        accelerator: "F5"
                    },
                    { type: 'separator' },
                    {
                        label: '&Editor',
                        accelerator: "CmdOrCtrl+E"
                    },
                    { type: 'separator' },
                    {
                        label: '&Backup',
                        enabled: false,
                        accelerator: "CmdOrCtrl+B"
                    },
                    {
                        label: '&Rename',
                        enabled: false,
                        accelerator: "F2"
                    },
                    {
                        label: '&Delete',
                        enabled: false,
                        accelerator: "Delete"
                    },
                    {
                        label: '&Create directory',
                        accelerator: "CmdOrCtrl+N"
                    },
                    { type: 'separator' },
                    {
                        label: '&Select all',
                        enabled: false,
                        accelerator: "CmdOrCtrl+A"
                    },
                    { type: 'separator' },
                    {
                        label: '&Open...',
                        enabled: false,
                        accelerator: "CmdOrCtrl+O"
                    },
                    {
                        label: 'Open &with...',
                        enabled: false,
                        submenu: [
                            {
                                label: '&Default',
                                //linux - xdg-open /filepath/file.txt
                                //windows jusy open wiht shell process?
                                //mac - Open <filename> ?
                                accelerator: "CmdOrCtrl++Shift+E"
                            },
                            {
                                label: '&Editor',
                            },
                        ]
                    },
                    { type: 'separator' },
                    {
                        label: '&Clear log...'
                    }
                ]
            },
            {
                label: '&View',
                submenu: [
                    { label: '&Show quere', type: 'checkbox' },
                    {
                        label: 'Sync folders',
                        type: 'checkbox',
                        accelerator: "CmdOrCtrl++Shift+S",
                        click: () => { toggleSync(); }
                    },
                    { type: 'separator' },
                    { label: 'Preferences...' },
                ]
            },
        ];
        var menubar = Menu.buildFromTemplate(menu);
        remote.getCurrentWindow().setMenu(menubar);

        function updateMenuItem(args) {
            var item, i = 0, ic, items;
            var tItem, tItems;
            if (args == null || args.menu == null) return;

            if (!Array.isArray(args.menu))
                args.menu = args.menu.split('|');

            items = menubar.items;
            tItems = menu;
            for (i = 0; i < args.menu.length; i++) {
                if (!items || items.length == 0) break;
                for (m = 0; m < items.length; m++) {
                    if (items[m].id == args.menu[i] || items[m].label.toLowerCase().replace(/&/g, '') == args.menu[i].toLowerCase()) {
                        item = items[m];
                        tItem = tItems[m];
                        if (item.submenu) {
                            items = item.submenu.items;
                            tItems = tItem.submenu;
                        }
                        else
                            items = null;
                        break;
                    }
                }
            }
            if (!item)
                return;
            if (args.enabled != null)
                item.enabled = args.enabled ? true : false;
            if (args.checked != null)
                item.checked = args.checked ? true : false;
            if (args.icon != null)
                item.icon = args.icon;
            if (args.visible != null)
                item.visible = args.visible ? true : false;
            if (args.position != null)
                item.position = args.position;

            tItem.enabled = item.enabled;
            tItem.checked = item.checked;
            tItem.icon = item.icon;
            tItem.visible = item.visible;
            tItem.position = item.position;
        }


        (function () {
            function fileSort(a, b) {
                if (_local[a].size == -2 && _local[b].size != -2)
                    return -1;
                if (_local[a].size != -2 && _local[b].size == -2)
                    return 1;
                return a.localeCompare(b);
            }


            function rfileSort(a, b) {
                if (_remote[a].size == -2 && _remote[b].size != -2)
                    return -1;
                if (_remote[a].size != -2 && _remote[b].size == -2)
                    return 1;
                return a.localeCompare(b);
            }

            jQuery.extend(jQuery.fn.dataTableExt.oSort, {
                "file-asc": function (a, b) {
                    return fileSort(a, b);
                },

                "file-desc": function (a, b) {
                    return fileSort(a, b) * -1;
                },

                "rfile-asc": function (a, b) {
                    return rfileSort(a, b);
                },

                "rfile-desc": function (a, b) {
                    return rfileSort(a, b) * -1;
                },

                "moment-asc": function (a, b) {
                    if (moment(a).isBefore(b))
                        return -1;
                    if (moment(b).isBefore(a))
                        return 1;
                    return 0;
                },

                "moment-desc": function (a, b) {
                    if (moment(a).isBefore(b))
                        return 1;
                    if (moment(b).isBefore(a))
                        return -1;
                    return 0;
                },

            });
        }());

        function loadOptions() {
            var set = Settings.load(remote.getGlobal('settingsFile'));
            options = set.extensions["IED"];
            if (!options) {
                options = {
                    'local': '',
                    'remote': '',
                    'editor': '',
                    'bufferSize': 0,
                    'openEditor': true,
                    'deleteLocal': false,
                    'cacheType': CacheType.create,
                    'queueSize': 250,
                    'localSize': 400,
                    'syncFolders': true,
                    'showQueue': true,
                    'echo': Echo.none,
                    'showHidden': false
                };
                saveOptions();
            }
            updateMenuItem({ menu: 'view|sync folders', checked: options.syncFolders });
            if (options.syncFolders)
                $("#btn-sync").addClass("active")
            else
                $('#btn-sync').removeClass('active');
        }

        function saveOptions() {
            ipcRenderer.send('setting-changed', { type: 'extensions', name: 'IED', value: options });
        }

        function updateLocal(p) {
            if (!p || p.length == 0)
                p = options.local || app.getPath('downloads');
            else if (!fs.existsSync(p))
                p = app.getPath('downloads');
            options.local = p;
            saveOptions();
            var parts = p.split(path.sep);
            if (p.endsWith(path.sep))
                parts.pop();
            var dir = fs.readdirSync(p);
            var dirs = [];
            var all = [];
            _local = {};
            for (var d = 0, dl = dir.length; d < dl; d++) {
                try {
                    file = IED.getFileInfo(path.join(p, dir[d]));
                }
                catch (error) {
                    console.log(error);
                    continue;
                }
                if (file.hidden && !options.showhidden)
                    continue;
                if (file.size == -2)
                    dirs.push(file);
                all.push(file);
                _local[file.name] = file;
            }

            $("#local-path").val(p);
            $("#local-navigate").empty();
            drivelist.list((error, drives) => {
                if (error) {
                    logMessage(error);
                    return;
                }
                var paths = [];
                var found = false;
                var c = "";
                if (drives.length > 0) {
                    for (var d = 0, dl = drives.length; d < dl; d++) {
                        if (drives[d].mountpoints.length === 0)
                            continue;
                        for (var m = 0, ml = drives[d].mountpoints.length; m < ml; m++) {
                            if (!drives[d].mountpoints[m].path) continue;
                            var sd = drives[d].mountpoints[m].path.split(path.sep);
                            c = "";
                            for (var pt = 0, pl = sd.length; pt < pl; pt++) {
                                c = path.join(c, sd[pt], path.sep);
                                if (c.toLowerCase() == parts[0].toLowerCase() + path.sep) {
                                    found = true;
                                    if (pt == 0)
                                        paths.push({ drive: true, path: c, name: sd[pt], count: pt, open: parts.length == 1 });
                                    else
                                        paths.push({ path: c, name: sd[pt], count: pt, open: parts.length == 1 });
                                }
                                else if (pt == 0)
                                    paths.push({ drive: true, path: c, name: sd[pt], count: pt });
                                else
                                    paths.push({ path: c, name: sd[pt], count: pt });
                            }
                            //paths.push({ drive: true, count: 0, path: path.join(drives[d].mountpoints[m].path, path.sep), name: drives[d].mountpoints[m].path });

                        }
                    }
                }
                c = found ? c = path.join(parts[0], path.sep) : "";
                for (var pt = found ? 1 : 0, pl = parts.length; pt < pl; pt++) {
                    c = path.join(c, parts[pt], path.sep);
                    if (pt == pl - 1)
                        paths.push({ path: c, name: parts[pt], count: pt, open: true });
                    else
                        paths.push({ path: c, name: parts[pt], count: pt });
                }
                for (var d = 0, dl = dirs.length; d < dl; d++) {
                    paths.push({ path: dirs[d].path, name: dirs[d].name, count: pt });
                }

                paths.sort(function compare(a, b) {
                    if (a.path.toUpperCase() < b.path.toUpperCase())
                        return -1;
                    if (a.path.toUpperCase() > b.path.toUpperCase())
                        return 1;
                    return 0;
                });
                $("#local-navigate").empty();
                for (var c = 0, cl = paths.length; c < cl; c++) {
                    if (paths[c].drive && paths[c].open)
                        $("#local-navigate").append(`<li><a href="#" class="active" data-path="${paths[c].path}" style="padding-left: ${20 + paths[c].count * 15}px"><i class="fa fa-server"></i> ${paths[c].name}</a></li>`)
                    else if (paths[c].drive)
                        $("#local-navigate").append(`<li><a href="#" data-path="${paths[c].path}" style="padding-left: ${20 + paths[c].count * 15}px"><i class="fa fa-server"></i> ${paths[c].name}</a></li>`)
                    else if (paths[c].open)
                        $("#local-navigate").append(`<li><a href="#" class="active" data-path="${paths[c].path}" style="padding-left: ${20 + paths[c].count * 15}px"><i class="fa fa-folder-open-o"></i> ${paths[c].name}</a></li>`)
                    else
                        $("#local-navigate").append(`<li><a href="#" data-path="${paths[c].path}" style="padding-left: ${20 + paths[c].count * 15}px"><i class="fa fa-folder-o"></i> ${paths[c].name}</a></li>`)
                }
            });

            var table = $('#local-list').DataTable();

            table.rows().remove().draw();
            table.rows.add(all).draw();


            $("#btn-local-up").prop('disabled', path.dirname(p) == p || path.dirname == path.join(p, path.sep));
        }

        function updateRemote(p, dir) {
            options.remote = p;
            saveOptions();
            var dirs = [];
            var all = [];
            var parts = p.split('/');
            if (p.endsWith('/'))
                parts.pop();
            _remote = {};
            for (var d = 0, dl = dir.length; d < dl; d++) {
                file = {
                    name: path.basename(dir[d].file),
                    path: (p == "/" ? "" : p) + "/" + dir[d].file,
                    size: dir[d].size,
                    type: path.extname(dir[d].file),
                    date: dir[d].date * 1000
                }
                if (file.size == -2) {
                    file.type = "Directory";
                    dirs.push(file);
                }
                all.push(file);
                _remote[file.name] = file;
            }
            $("#remote-path").val(p);
            var paths = [];
            var c = [];
            for (var pt = 0, pl = parts.length; pt < pl; pt++) {
                c.push(parts[pt]);
                if (pt == 0)
                    paths.push({ path: "/", name: "/", count: pt, open: pt == pl - 1 });
                else
                    paths.push({ path: c.join('/'), name: parts[pt], count: pt, open: pt == pl - 1 });
            }
            for (var d = 0, dl = dirs.length; d < dl; d++) {
                paths.push({ path: dirs[d].path, name: dirs[d].name, count: pt });
            }

            paths.sort(function compare(a, b) {
                if (a.path.toUpperCase() < b.path.toUpperCase())
                    return -1;
                if (a.path.toUpperCase() > b.path.toUpperCase())
                    return 1;
                return 0;
            });
            $("#remote-navigate").empty();
            for (var c = 0, cl = paths.length; c < cl; c++) {
                if (paths[c].drive && paths[c].open)
                    $("#remote-navigate").append(`<li><a href="#" class="active" data-path="${paths[c].path}" style="padding-left: ${20 + paths[c].count * 15}px"><i class="fa fa-server"></i> ${paths[c].name}</a></li>`)
                else if (paths[c].drive)
                    $("#remote-navigate").append(`<li><a href="#" data-path="${paths[c].path}" style="padding-left: ${20 + paths[c].count * 15}px"><i class="fa fa-server"></i> ${paths[c].name}</a></li>`)
                else if (paths[c].open)
                    $("#remote-navigate").append(`<li><a href="#" class="active" data-path="${paths[c].path}" style="padding-left: ${20 + paths[c].count * 15}px"><i class="fa fa-folder-open-o"></i> ${paths[c].name}</a></li>`)
                else
                    $("#remote-navigate").append(`<li><a href="#" data-path="${paths[c].path}" style="padding-left: ${20 + paths[c].count * 15}px"><i class="fa fa-folder-o"></i> ${paths[c].name}</a></li>`)
            }
            var table = $('#remote-list').DataTable();
            table.rows().remove().draw();
            table.rows.add(all).draw();
            $("#btn-remote-up").prop('disabled', path.dirname(p) == p || path.dirname == path.join(p, path.sep));
        }

        function logMessage(msg) {
            $("#log-view").html($("#log-view").html() + msg.toString() + "<br>");
        }

        $(document).ready(() => {

            loadOptions();
            _ied = new IED();
            _ied.on('error', (err) => {
                console.log(err);
            })
            _ied.on('reset', () => {

            })
            _ied.on('dir', (dir, files) => {
                updateRemote(dir, files)
            });
            _ied.on('resolved', (dir, tag) => {
                logMessage("Resolved: " + dir);
            });
            _ied.on('message', (msg) => {
                logMessage(msg);
            })

            $('#local-list').DataTable({
                keys: {
                    blurable: false
                },
                paging: false,
                select: {
                    style: 'os',
                    //blurable: true
                },
                searching: false,
                info: false,
                scrollY: 300,
                scrollX: 300,
                fixedHeader: {
                    header: true,
                    footer: false
                },
                scrollResize: true,
                language: { zeroRecords: "", emptyTable: "" },
                autoWidth: false,
                columnDefs: [
                    {
                        type: 'file',
                        targets: 0,
                        createdCell: function (td, cellData, rowData, row, col) {
                            if (rowData.size == -2) {
                                $(td).prepend('<i class="fa fa-folder-o" style="margin-right: 2px"></i>');
                            }
                            else {
                                switch (rowData.type.toLowerCase()) {
                                    case ".7z":
                                    case ".zip":
                                    case ".rar":
                                        $(td).prepend('<i class="fa fa-file-archive-o" style="margin-right: 2px"></i>');
                                        break;
                                    case ".txt":
                                        $(td).prepend('<i class="fa fa-file-text-o" style="margin-right: 2px"></i>');
                                        break;
                                    case ".h":
                                    case ".c":
                                        $(td).prepend('<i class="fa fa-file-code-o" style="margin-right: 2px"></i>');
                                        break;
                                    default:
                                        $(td).prepend('<i class="fa fa-file-o" style="margin-right: 2px"></i>');
                                        break;
                                }
                            }
                        }
                    },
                    {
                        render: function (data, type, full, meta) {
                            if (data == -2)
                                return '';
                            return data;
                        },
                        targets: 1
                    },
                    {
                        render: function (data, type, full, meta) {
                            if (data == -2)
                                return '';
                            return data;
                        },
                        targets: 1
                    },
                    {
                        type: "moment",
                        targets: 3,
                        render: function (data) {
                            return new moment(data).format('MM/DD/YYYY hh:mm:ss A');
                        }
                    }
                ],
                columns: [
                    { data: 'name', width: '200px' },
                    { data: 'size', width: '200px' },
                    { data: 'type', width: '200px' },
                    { data: 'date', width: '200px' }
                ]
            });
            $('#remote-list').DataTable({
                keys: {
                    blurable: false
                },
                paging: false,
                select: {
                    style: 'os',
                    //blurable: true
                },
                searching: false,
                info: false,
                scrollY: 300,
                scrollX: 300,
                fixedHeader: {
                    header: true,
                    footer: false
                },
                scrollResize: true,
                language: { zeroRecords: "", emptyTable: "" },
                autoWidth: false,
                columnDefs: [
                    {
                        type: 'rfile',
                        targets: 0,
                        createdCell: function (td, cellData, rowData, row, col) {
                            if (rowData.size == -2) {
                                $(td).prepend('<i class="fa fa-folder-o" style="margin-right: 2px"></i>');
                            }
                            else {
                                switch (rowData.type.toLowerCase()) {
                                    case ".7z":
                                    case ".zip":
                                    case ".rar":
                                        $(td).prepend('<i class="fa fa-file-archive-o" style="margin-right: 2px"></i>');
                                        break;
                                    case ".txt":
                                        $(td).prepend('<i class="fa fa-file-text-o" style="margin-right: 2px"></i>');
                                        break;
                                    case ".h":
                                    case ".c":
                                        $(td).prepend('<i class="fa fa-file-code-o" style="margin-right: 2px"></i>');
                                        break;
                                    default:
                                        $(td).prepend('<i class="fa fa-file-o" style="margin-right: 2px"></i>');
                                        break;
                                }
                            }
                        }
                    },
                    {
                        render: function (data, type, full, meta) {
                            if (data == -2)
                                return '';
                            return data;
                        },
                        targets: 1
                    },
                    {
                        render: function (data, type, full, meta) {
                            if (data == -2)
                                return '';
                            return data;
                        },
                        targets: 1
                    },
                    {
                        type: "moment",
                        targets: 3,
                        render: function (data) {
                            return new moment(data).format('MM/DD/YYYY hh:mm:ss A');
                        }
                    }
                ],
                columns: [
                    { data: 'name', width: '200px' },
                    { data: 'size', width: '200px' },
                    { data: 'type', width: '200px' },
                    { data: 'date', width: '200px' }
                ]
            });
            $('#queue-list').DataTable({
                data: [],
                paging: false,
                select: true,
                searching: false,
                info: false,
                scrollY: 300,
                scrollX: '100vw',
                fixedHeader: {
                    header: true,
                    footer: false
                },
                scrollResize: true,
                ordering: false,
                language: { zeroRecords: "", emptyTable: "" }
            });

            $('#local-list').DataTable().on('user-select', function (e, dt, type, cell, originalEvent) {
                if ($(cell.node()).parent().hasClass('selected') && dt.rows('.selected').data().length == 1) {
                    e.preventDefault();
                }
            });

            $('#remote-list').DataTable().on('user-select', function (e, dt, type, cell, originalEvent) {
                if ($(cell.node()).parent().hasClass('selected') && dt.rows('.selected').data().length == 1) {
                    e.preventDefault();
                }
            });

            $('#local-list tbody').on('dblclick', 'tr', function () {
                var data = $('#local-list').DataTable().row(this).data();
                if (data.size == -2) {
                    if (options.syncFolders) {
                        if (_remote[data.name] && path.basename(options.remote) == path.basename(options.local))
                            _ied.getDir(options.remote + "/" + data.name, true);
                    }
                    updateLocal(data.path);
                }
            });

            $('#remote-list tbody').on('dblclick', 'tr', function () {
                var data = $('#remote-list').DataTable().row(this).data();
                if (data.size == -2) {
                    if (options.syncFolders) {
                        if (_local[data.name] && path.basename(options.remote) == path.basename(options.remote))
                            updateLocal(path.join(options.local, data.name));
                    }
                    _ied.getDir(data.path, true);
                }
            });

            $("#local-list").on('focus', () => {
                $("#local-list").addClass('focused');
                $("#remote-list").removeClass('focused');
            });
            $("#remote-list").on('focus', () => {
                $("#local-list").removeClass('focused');
                $("#remote-list").addClass('focused');
            })
            updateLocal(options.local);
            if (!options.remote || options.remote.length === 0)
                _ied.getDir(".");
            else
                _ied.getDir(options.remote);

            $("#btn-local-up").on('click', () => {
                if (options.syncFolders) {
                    if (path.basename(options.remote) == path.basename(options.local))
                        _ied.getDir(path.dirname(options.remote), true);
                }
                updateLocal(path.dirname($("#local-path").val()));
            })

            $("#local-navigate").on('click', (e) => {
                e.preventDefault();
                e.cancelBubble = true;
                updateLocal($(e.target).data('path'));
            })

            $('#local-path').change(function () {
                updateLocal($("#local-path").val());
            });
            $('#local-path').keyup(function (e) {
                if (e.which == 13) {
                    //updateLocal($("#local-path").val());
                    //return false;
                }
                if (e.which == 27)
                    $("#local-path").val(options.local);
            });

            $("#btn-remote-up").on('click', () => {
                _ied.getDir(path.dirname($("#remote-path").val()), true);
                if (options.syncFolders) {
                    if (path.basename(options.remote) == path.basename(options.local))
                        updateLocal(path.dirname(options.local));
                }
            })

            $("#remote-navigate").on('click', (e) => {
                e.preventDefault();
                e.cancelBubble = true;
                _ied.getDir($(e.target).data('path'), true);
            })

            $('#remote-path').change(function () {
                _ied.getDir($("#remote-path").val());
            });
            $('#remote-path').keyup(function (e) {
                if (e.which == 13) {
                    //_ied.getDir($("#remote-path").val());
                    //return false;
                }
                if (e.which == 27)
                    $("#remote-path").val(options.remote);
            });


            $(window).on('resize', () => {
                var h = $("#main").outerHeight() + $("#bottom").outerHeight() - 40;
                $("#local-navigate").css("max-height", h + "px");
                $("#remote-navigate").css("max-height", h + "px");
            });
            $(window).trigger('resize');
        });

        function toggleSync() {
            options.syncFolders = !options.syncFolders;
            updateMenuItem({ menu: 'view|sync folders', checked: options.syncFolders });
            if (options.syncFolders)
                $("#btn-sync").addClass("active")
            else
                $('#btn-sync').removeClass('active');
            saveOptions();
        }

        ipcRenderer.on('GMCP-received', (event, data) => {
            _ied.processGMCP(data.mod, data.obj);
        });

        ipcRenderer.on('reload-options', (event) => {
            loadOptions()
        });
    </script>
</head>

<body>
    <div id="toolbar" class="btn-toolbar" role="toolbar">
        <button id="btn-refresh" type="button" class="btn btn-default btn-xs" title="Refresh" onclick=""><i class="fa fa-refresh"></i></button>
        <div class="btn-group" role="group">
            <button id="btn-upload" disabled="disabled" type="button" class="btn btn-default btn-xs" title="Upload files" onclick=""><i class="fa fa-upload"></i></button>
            <button id="btn-download" disabled="disabled" type="button" class="btn btn-default btn-xs" title="Download files" onclick=""><i class="fa fa-download"></i></button>
        </div>
        <div class="btn-group" role="group">
            <button id="btn-rename" disabled="disabled" type="button" class="btn btn-default btn-xs" title="Rename" onclick=""><i class="fa fa-i-cursor"></i></button>
            <button id="btn-delete" disabled="disabled" type="button" class="btn btn-danger btn-xs" title="Delete" onclick=""><i class="fa fa-times"></i></button>
        </div>
        <button id="btn-newfolder" type="button" class="btn btn-default btn-xs" title="Create directory" onclick="">
            <span class="fa-stack" style="top: -1px;width: 1em;height: 1em;line-height: 1em;font-size: 1em;">
                <i class="fa fa-folder-o fa-stack-2x" style="font-size: 1em"></i>
                <i class="fa fa-certificate fa-stack-1x" style="font-size: 0.8em;margin-top: -2px;left:5px;"></i>
            </span>                    
        </button>
        <!--
        <div class="btn-group" role="group" id="queue-controls">
            <button id="btn-restart" disabled="disabled" type="button" class="btn btn-default btn-xs" title="Restart" onclick=""><i class="fa fa-rotate-left"></i></button>
            <button id="btn-pause" disabled="disabled" type="button" class="btn btn-default btn-xs" title="Pause" onclick="" data-toggle="button"><i class="fa fa-pause"></i></button>
            <button id="btn-stop" disabled="disabled" type="button" class="btn btn-warning btn-xs" title="Stop" onclick=""><i class="fa fa-stop"></i></button>
        </div>
        -->

        <button id="btn-reset" type="button" class="btn btn-warning btn-xs" title="Reset all" onclick=""><i class="fa fa-eject"></i></button>

        <button id="btn-clear" type="button" class="btn btn-default btn-xs" title="Clear log" onclick="">
            <span class="fa-stack" style="top: -1px;width: 1em;height: 1em;line-height: 1em;font-size: 1em;">
                <i class="fa fa-file-o fa-stack-2x" style="font-size: 1em"></i>
                <i class="fa fa-times fa-stack-1x" style="font-size: 0.5em;margin-top: 1px;"></i>
            </span>                    
        </button>
        <button id="btn-queue" type="button" class="btn btn-default btn-xs" title="Show queue" onclick="" data-toggle="button"><i class="fa fa-list-alt"></i></button>
    </div>
    <div id="main">
        <div id="local">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <label class="control-label" for="local-path">
                        Local
                    </label>

                    <span class="path-container">
                    <div class="input-group">
                        <input type="text" id="local-path" class="form-control" />
                        <span class="input-group-btn" style="width: 17px;">
                            <button id="button-local" class="btn btn-default dropdown-toggle" style="width:100%;padding-left:4px;padding-right:4px;" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                <span class="caret" style="margin-left: -1px;"></span>
                    </button>
                    <ul id="local-navigate" class="dropdown-menu" aria-labelledby="button-local" data-container="body"></ul>
                    </span>
                </div>
                </span>
                <span class="path-buttons">
                            <button id="btn-local-up" disabled="disabled" type="button" class="btn btn-default btn-xs" title="Go up a directory" onclick="">
                                <span class="fa-stack" style="top: -1px;width: 1em;height: 1em;line-height: 1em;font-size: 1em;">
                                    <i class="fa fa-folder-o fa-stack-2x" style="font-size: 1.2em"></i>
                                    <i class="fa fa-caret-up fa-stack-1x" style="font-size: 1em;margin-top: 1px;"></i>
                                </span>
                </button>
                <button id="btn-sync" type="button" class="btn btn-default btn-xs" title="Sync folders" onclick="toggleSync();"><i class="fa fa-exchange"></i></button>
                </span>
            </div>
            <div class="panel-body" style="padding:0px;top:31px;bottom:1px;left:1px;right:5px;position: absolute;">
                <table tabindex="0" id="local-list" class="table table-striped table-hover table-condensed" style="width: 100%;height: 100%;padding:0px;margin:0px !important;">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Size</th>
                            <th>Type</th>
                            <th>Date Modified</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
        <div id="drag-bar"></div>
    </div>
    <div id="remote">
        <div class="panel panel-default">
            <div class="panel-heading">
                <label class="control-label" for="remote-path">
                        Remote
                    </label>

                <span class="path-container">
                    <div class="input-group">
                        <input type="text" id="remote-path" class="form-control" />
                        <span class="input-group-btn" style="width: 17px;">
                            <ul id="remote-navigate" class="dropdown-menu pull-right" aria-labelledby="button-remote" data-container="body"></ul>
                            <button id="button-remote" class="btn btn-default" style="width:100%;padding-left:4px;padding-right:4px;" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                <span class="caret" style="margin-left: -1px;"></span>
                </button>

                </span>
            </div>
            </span>
            <span class="path-buttons">
                            <button id="btn-remote-up" disabled="disabled" type="button" class="btn btn-default btn-xs" title="Go up a directory" onclick="">
                                <span class="fa-stack" style="top: -1px;width: 1em;height: 1em;line-height: 1em;font-size: 1em;">
                                    <i class="fa fa-folder-o fa-stack-2x" style="font-size: 1.2em"></i>
                                    <i class="fa fa-caret-up fa-stack-1x" style="font-size: 1em;margin-top: 1px;"></i>
                                </span>
            </button>
            </span>
        </div>
        <div class="panel-body" style="padding:0px;top:31px;bottom:1px;left:1px;right:1px;position: absolute;">
            <table tabindex="0" id="remote-list" class="table table-striped table-hover table-condensed" style="width: 100%;height: 100%;padding:0px;margin:0px !important;">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Size</th>
                        <th>Type</th>
                        <th>Date Modified</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
    </div>
    </div>
    <div id="bottom">
        <ul class="nav nav-tabs" role="tablist" style="background-color: #F5F5F5;box-shadow: inset 0 -1px 0 #fff;">
            <li role="presentation" class="active"><a href="#queue" aria-controls="queue" role="tab" data-toggle="tab">Queue</a></li>
            <li role="presentation"><a href="#log" aria-controls="log" role="tab" data-toggle="tab">Log</a></li>
        </ul>
        <div class="tab-content" style="padding: 4px;position: absolute;left: 0;right: 0;bottom: 0;top: 46px;">
            <div role="tabpanel" class="tab-pane fade in active" id="queue" style="margin:0 !important;padding:4px;height:100%;">
                <table id="queue-list" class="table table-striped table-hover table-condensed" style="width: 100%;height: 100%;padding:0px;margin:0 !important;">
                    <thead>
                        <tr>
                            <th>Local</th>
                            <th>&lt;-&gt;</th>
                            <th>Remote</th>
                            <th>Progress</th>
                        </tr>
                    </thead>
                </table>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="log" style="padding:4px;height:100%;">
                <pre id="log-view" style="width:100%;height:100%;border:1px solid rgb(221, 221, 221);overflow:auto;"></pre>
            </div>
        </div>
</body>

</html>